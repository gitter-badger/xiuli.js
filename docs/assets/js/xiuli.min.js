!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("xiuli",[],t):"object"==typeof exports?exports.xiuli=t():e.xiuli=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";function r(e){for(var t=getComputedStyle(e,null),n={},r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.forEach(function(e){var r=t.getPropertyValue("-webkit-"+e)||t.getPropertyValue("-moz-"+e)||t.getPropertyValue("-ms-"+e)||t.getPropertyValue("-o-"+e)||t.getPropertyValue(""+e)||"none";n[e]=r}),n}Object.defineProperty(t,"__esModule",{value:!0});var o="undefined"!=typeof Float32Array?Float32Array:Array;t.ARRAY_TYPE=o,t.getCSSStyles=r},function(e,t,n){"use strict";var r=n(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r),i=new o.default;e.exports=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(3),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xiuli";r(this,e);var n=document.querySelectorAll("[xiuli-target]");this.main=document.getElementById(t),this.root=this.main.parentElement,this.mainTrans=a.Mat4.fromElement(this.main),this.elements={},Array.prototype.forEach.call(n,this.init.bind(this))}return i(e,[{key:"init",value:function(e,t){var n=e.getAttribute("xiuli-target"),r=document.getElementById(n),i=(0,a.getCSSStyles)(r,"transform","transform-origin"),u=i.transform,l=i["transform-origin"],f=/[-+]?[0-9]*\.?[0-9]+/g,s=l.match(f),c=o(s,3),y=c[0],v=void 0===y?0:y,d=c[1],m=void 0===d?0:d,p=c[2],h=void 0===p?0:p,g=a.Mat4.fromCSSTransform(u),b=a.Vec3.fromValues(v,m,h),A=a.Mat4.fromTranslation(b);a.Mat4.multiply(A,g,g),a.Vec3.negate(b,b),b[0]-=(this.root.offsetWidth-r.offsetWidth)/2,b[1]-=(window.innerHeight-r.offsetHeight)/2,a.Mat4.fromTranslation(b,A),a.Mat4.multiply(g,A,g),a.Mat4.invert(g,g),a.Mat4.multiply(this.mainTrans,g,g),this.elements[n]=a.Mat4.toCssTransform(g),0===t&&(this.main.style.transform=this.elements[n]),e.addEventListener("click",this.onMenuClick.bind(this))}},{key:"onMenuClick",value:function(e){var t=e.target,n=t.getAttribute("xiuli-target");this.main.style.transform=this.elements[n]}},{key:"on",value:function(e,t){this.main.addEventListener(e,function(e){t(e)},!1)}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Mat4=t.Vec3=t.getCSSStyles=t.ARRAY_TYPE=void 0;var o=n(0),i=n(4),a=r(i),u=n(5),l=r(u);t.ARRAY_TYPE=o.ARRAY_TYPE,t.getCSSStyles=o.getCSSStyles,t.Vec3=a.default,t.Mat4=l.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=function(){function e(){r(this,e)}return o(e,null,[{key:"fromValues",value:function(e,t,n){var r=new i.ARRAY_TYPE(3);return r[0]=e,r[1]=t,r[2]=n,r}},{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{key:"negate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(3);return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=function(){function e(){r(this,e)}return o(e,null,[{key:"create",value:function(){var e=new i.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{key:"fromTranslation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}},{key:"multiply",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.ARRAY_TYPE(16),r=e[0],o=e[1],a=e[2],u=e[3],l=e[4],f=e[5],s=e[6],c=e[7],y=e[8],v=e[9],d=e[10],m=e[11],p=e[12],h=e[13],g=e[14],b=e[15],A=t[0],S=t[1],_=t[2],P=t[3];return n[0]=A*r+S*l+_*y+P*p,n[1]=A*o+S*f+_*v+P*h,n[2]=A*a+S*s+_*d+P*g,n[3]=A*u+S*c+_*m+P*b,A=t[4],S=t[5],_=t[6],P=t[7],n[4]=A*r+S*l+_*y+P*p,n[5]=A*o+S*f+_*v+P*h,n[6]=A*a+S*s+_*d+P*g,n[7]=A*u+S*c+_*m+P*b,A=t[8],S=t[9],_=t[10],P=t[11],n[8]=A*r+S*l+_*y+P*p,n[9]=A*o+S*f+_*v+P*h,n[10]=A*a+S*s+_*d+P*g,n[11]=A*u+S*c+_*m+P*b,A=t[12],S=t[13],_=t[14],P=t[15],n[12]=A*r+S*l+_*y+P*p,n[13]=A*o+S*f+_*v+P*h,n[14]=A*a+S*s+_*d+P*g,n[15]=A*u+S*c+_*m+P*b,n}},{key:"invert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(16),n=e[0],r=e[1],o=e[2],a=e[3],u=e[4],l=e[5],f=e[6],s=e[7],c=e[8],y=e[9],v=e[10],d=e[11],m=e[12],p=e[13],h=e[14],g=e[15],b=n*l-r*u,A=n*f-o*u,S=n*s-a*u,_=r*f-o*l,P=r*s-a*l,T=o*s-a*f,w=c*p-y*m,E=c*h-v*m,R=c*g-d*m,Y=y*h-v*p,k=y*g-d*p,x=v*g-d*h,M=b*x-A*k+S*Y+_*R-P*E+T*w;return M?(M=1/M,t[0]=(l*x-f*k+s*Y)*M,t[1]=(o*k-r*x-a*Y)*M,t[2]=(p*T-h*P+g*_)*M,t[3]=(v*P-y*T-d*_)*M,t[4]=(f*R-u*x-s*E)*M,t[5]=(n*x-o*R+a*E)*M,t[6]=(h*S-m*T-g*A)*M,t[7]=(c*T-v*S+d*A)*M,t[8]=(u*k-l*R+s*w)*M,t[9]=(r*R-n*k-a*w)*M,t[10]=(m*P-p*S+g*b)*M,t[11]=(y*S-c*P-d*b)*M,t[12]=(l*E-u*Y-f*w)*M,t[13]=(n*Y-r*E+o*w)*M,t[14]=(p*A-m*_-h*b)*M,t[15]=(c*_-y*A+v*b)*M,t):null}},{key:"fromCSSTransform",value:function(e){var t=/\(|\)|, |\s/g,n=e.split(t),r=this.create();return"matrix"===n[0]?(r[0]=parseFloat(n[1]),r[1]=parseFloat(n[2]),r[4]=parseFloat(n[3]),r[5]=parseFloat(n[4]),r[12]=parseFloat(n[5]),r[13]=parseFloat(n[6])):"matrix3d"===n[0]&&this.copy(n.slice(1,17).map(function(e){return parseFloat(e)}),r),r}},{key:"fromElement",value:function(e){var t=(0,i.getCSSStyles)(e,"transform"),n=t.transform;return this.fromCSSTransform(n)}},{key:"toCssTransform",value:function(e){return"matrix3d("+e.join(",")+")"}}]),e}();t.default=a}])});