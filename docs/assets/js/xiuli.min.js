!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("xiuli",[],e):"object"==typeof exports?exports.xiuli=e():t.xiuli=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";function r(t){for(var e=getComputedStyle(t,null),n={},r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.forEach(function(t){var r=e.getPropertyValue("-webkit-"+t)||e.getPropertyValue("-moz-"+t)||e.getPropertyValue("-ms-"+t)||e.getPropertyValue("-o-"+t)||e.getPropertyValue(""+t)||"none";n[t]=r}),n}Object.defineProperty(e,"__esModule",{value:!0});var o="undefined"!=typeof Float32Array?Float32Array:Array;e.ARRAY_TYPE=o,e.getCSSStyles=r},function(t,e,n){"use strict";var r=n(2),o=function(t){return t&&t.__esModule?t:{default:t}}(r);!function(){var e=new o.default;t.exports=e}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),u=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xiuli";r(this,t);var o=document.querySelectorAll("[xiuli-target]");this.main=document.getElementById(n),this.root=this.main.parentElement;var i=this.root.getBoundingClientRect(),u=i.x,l=i.y;this.root.x=u,this.root.y=l,this.callback=null,this.clicked=null,this.main.addEventListener("transitionend",function(){e.callback&&e.clicked&&(e.callback(e.clicked),e.clicked=null)},!1),this.mainTrans=a.Mat4.fromElement(this.main),this.elements={},Array.prototype.forEach.call(o,this.init.bind(this))}return i(t,[{key:"init",value:function(t,e){var n=t.getAttribute("xiuli-target"),r=document.getElementById(n),i=(0,a.getCSSStyles)(r,"transform","transform-origin"),u=i.transform,l=i["transform-origin"],c=/[-+]?[0-9]*\.?[0-9]+/g,f=l.match(c),s=o(f,3),y=s[0],d=void 0===y?0:y,v=s[1],m=void 0===v?0:v,p=s[2],h=void 0===p?0:p,g=a.Mat4.fromCSSTransform(u),b=a.Vec3.fromValues(d,m,h),A=a.Mat4.fromTranslation(b);a.Mat4.multiply(A,g,g),a.Vec3.negate(b,b),b[0]-=(window.innerWidth-r.offsetWidth)/2-this.root.x,b[1]-=(window.innerHeight-r.offsetHeight)/2-this.root.y,a.Mat4.fromTranslation(b,A),a.Mat4.multiply(g,A,g),a.Mat4.invert(g,g),a.Mat4.multiply(this.mainTrans,g,g),this.elements[n]=a.Mat4.toCssTransform(g),0===e&&(this.main.style.transform=this.elements[n]),t.addEventListener("click",this.onMenuClick.bind(this))}},{key:"onMenuClick",value:function(t){var e=t.target,n=e.getAttribute("xiuli-target");this.main.style.transform=this.elements[n],this.clicked=e}},{key:"onTransitionend",value:function(t){this.callback=t}}]),t}();e.default=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Mat4=e.Vec3=e.getCSSStyles=e.ARRAY_TYPE=void 0;var o=n(0),i=n(4),a=r(i),u=n(5),l=r(u);e.ARRAY_TYPE=o.ARRAY_TYPE,e.getCSSStyles=o.getCSSStyles,e.Vec3=a.default,e.Mat4=l.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),a=function(){function t(){r(this,t)}return o(t,null,[{key:"fromValues",value:function(t,e,n){var r=new i.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r}},{key:"copy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{key:"negate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(3);return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),a=function(){function t(){r(this,t)}return o(t,null,[{key:"create",value:function(){var t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"copy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{key:"fromTranslation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}},{key:"multiply",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.ARRAY_TYPE(16),r=t[0],o=t[1],a=t[2],u=t[3],l=t[4],c=t[5],f=t[6],s=t[7],y=t[8],d=t[9],v=t[10],m=t[11],p=t[12],h=t[13],g=t[14],b=t[15],A=e[0],k=e[1],S=e[2],_=e[3];return n[0]=A*r+k*l+S*y+_*p,n[1]=A*o+k*c+S*d+_*h,n[2]=A*a+k*f+S*v+_*g,n[3]=A*u+k*s+S*m+_*b,A=e[4],k=e[5],S=e[6],_=e[7],n[4]=A*r+k*l+S*y+_*p,n[5]=A*o+k*c+S*d+_*h,n[6]=A*a+k*f+S*v+_*g,n[7]=A*u+k*s+S*m+_*b,A=e[8],k=e[9],S=e[10],_=e[11],n[8]=A*r+k*l+S*y+_*p,n[9]=A*o+k*c+S*d+_*h,n[10]=A*a+k*f+S*v+_*g,n[11]=A*u+k*s+S*m+_*b,A=e[12],k=e[13],S=e[14],_=e[15],n[12]=A*r+k*l+S*y+_*p,n[13]=A*o+k*c+S*d+_*h,n[14]=A*a+k*f+S*v+_*g,n[15]=A*u+k*s+S*m+_*b,n}},{key:"invert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.ARRAY_TYPE(16),n=t[0],r=t[1],o=t[2],a=t[3],u=t[4],l=t[5],c=t[6],f=t[7],s=t[8],y=t[9],d=t[10],v=t[11],m=t[12],p=t[13],h=t[14],g=t[15],b=n*l-r*u,A=n*c-o*u,k=n*f-a*u,S=r*c-o*l,_=r*f-a*l,w=o*f-a*c,P=s*p-y*m,T=s*h-d*m,E=s*g-v*m,R=y*h-d*p,x=y*g-v*p,Y=d*g-v*h,M=b*Y-A*x+k*R+S*E-_*T+w*P;return M?(M=1/M,e[0]=(l*Y-c*x+f*R)*M,e[1]=(o*x-r*Y-a*R)*M,e[2]=(p*w-h*_+g*S)*M,e[3]=(d*_-y*w-v*S)*M,e[4]=(c*E-u*Y-f*T)*M,e[5]=(n*Y-o*E+a*T)*M,e[6]=(h*k-m*w-g*A)*M,e[7]=(s*w-d*k+v*A)*M,e[8]=(u*x-l*E+f*P)*M,e[9]=(r*E-n*x-a*P)*M,e[10]=(m*_-p*k+g*b)*M,e[11]=(y*k-s*_-v*b)*M,e[12]=(l*T-u*R-c*P)*M,e[13]=(n*R-r*T+o*P)*M,e[14]=(p*A-m*S-h*b)*M,e[15]=(s*S-y*A+d*b)*M,e):null}},{key:"fromCSSTransform",value:function(t){var e=/\(|\)|, |\s/g,n=t.split(e),r=this.create();return"matrix"===n[0]?(r[0]=parseFloat(n[1]),r[1]=parseFloat(n[2]),r[4]=parseFloat(n[3]),r[5]=parseFloat(n[4]),r[12]=parseFloat(n[5]),r[13]=parseFloat(n[6])):"matrix3d"===n[0]&&this.copy(n.slice(1,17).map(function(t){return parseFloat(t)}),r),r}},{key:"fromElement",value:function(t){var e=(0,i.getCSSStyles)(t,"transform"),n=e.transform;return this.fromCSSTransform(n)}},{key:"toCssTransform",value:function(t){return"matrix3d("+t.join(",")+")"}}]),t}();e.default=a}])});