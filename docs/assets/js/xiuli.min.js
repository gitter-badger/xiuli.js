!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Xiuli",[],e):"object"==typeof exports?exports.Xiuli=e():t.Xiuli=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";function r(t){for(var e=getComputedStyle(t,null),n={},r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i.forEach(function(t){var r=e.getPropertyValue("-webkit-"+t)||e.getPropertyValue("-moz-"+t)||e.getPropertyValue("-ms-"+t)||e.getPropertyValue("-o-"+t)||e.getPropertyValue(""+t)||"none";n[t]=r}),n}Object.defineProperty(e,"__esModule",{value:!0});var i="undefined"!=typeof Float32Array?Float32Array:Array;e.ARRAY_TYPE=i,e.getCSSStyles=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=i.default,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),s=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xiuli",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;r(this,t),this.TFun=i,this.elementIds=[],this.xiulies=document.querySelectorAll("[xiuli-target]"),this.current=-1,this.main=document.getElementById(n),this.main.style.position="absolute",this.main.style.transformStyle="preserve-3d","0s"===(0,a.getCSSStyles)(this.main,"transition","transition-duration")["transition-duration"]&&(this.main.style.transitionDuration="2s",this.main.style.WebkitTransitionDuration="2s"),this.root=this.main.parentElement;var o=this.root.getBoundingClientRect(),s=o.left,u=o.top;this.root.x=s,this.root.y=u,this.callback=null,this.data=null,this.main.addEventListener("transitionend",function(){e.callback&&(e.callback(e.elementIds[e.current],e.data),e.data=null)},!1),this.mainTrans=a.Mat4.fromElement(this.main),this.elements={},this.init(i)}return o(t,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.TFun=e,this.elementIds=[],this.current=-1,this.TFun instanceof Function&&Array.prototype.forEach.call(this.xiulies,function(e,n,r){var i=a.Mat4.create();i=t.TFun(i,n,r),e.style.transform=a.Mat4.toCssTransform(i)}),Array.prototype.forEach.call(this.xiulies,function(e,n){var r=!1;0===n&&(r=!0),t.add(e,r)})}},{key:"add",value:function(t,e){var n=(0,a.getCSSStyles)(t,"transform","transform-origin"),r=n.transform,o=n["transform-origin"],s=/[-+]?[0-9]*\.?[0-9]+/g,u=o.match(s),l=i(u,3),c=l[0],f=void 0===c?0:c,d=l[1],h=void 0===d?0:d,v=l[2],m=void 0===v?0:v,y=a.Mat4.fromCSSTransform(r),p=a.Vec3.fromValues(f,h,m),g=a.Mat4.fromTranslation(p);a.Mat4.multiply(g,y,y),a.Vec3.negate(p,p);var M=document.documentElement.clientWidth||document.body.clientWidth,A=document.documentElement.clientHeight||document.body.clientHeight;p[0]-=(M-t.offsetWidth)/2-this.root.x,p[1]-=(A-t.offsetHeight)/2-this.root.y,a.Mat4.fromTranslation(p,g),a.Mat4.multiply(y,g,y),a.Mat4.invert(y,y),a.Mat4.multiply(this.mainTrans,y,y),this.elements[t.id]=a.Mat4.toCssTransform(y),this.elementIds.push(t.id),e&&(this.main.style.transform=this.elements[t.id],this.clicked=t)}},{key:"onTransitionend",value:function(t){this.callback=t}},{key:"goto",value:function(t,e){var n=this.elementIds.indexOf(t);-1!==n&&(this.main.style.transform=this.elements[t],this.data=e,this.current=n)}},{key:"pre",value:function(t){this.current-=1,this.current<0&&(this.current=this.elementIds.length-1);var e=this.elementIds[this.current];this.goto(e,t)}},{key:"next",value:function(t){this.current+=1,this.current>=this.elementIds.length&&(this.current=0);var e=this.elementIds[this.current];this.goto(e,t)}}],[{key:"spiralSteps",value:function(t,e,n){var r=6.28319*e/n.length;return a.Mat4.rotate(t,r-1.5708,a.Vec3.fromValues(0,1,0),t),t[12]=500*Math.sin(r),t[13]=-400*e,t[14]=500*(Math.cos(r)-1),t}},{key:"spiralRotated",value:function(t,e){var n=6.28319*e/6;return a.Mat4.rotate(t,n,a.Vec3.fromValues(0,1,0),t),t[12]=600*Math.sin(n),t[13]=200*e,t[14]=600*(Math.cos(n)-1),t}},{key:"poly",value:function(t,e){var n=6.28319*e/6;return a.Mat4.rotate(t,n,a.Vec3.fromValues(0,1,0),t),t[12]=600*Math.sin(n),t[13]=200,t[14]=600*(Math.cos(n)-1),t}},{key:"circular",value:function(t,e){var n=6.28319*e/6;return t[12]=600*Math.sin(n),t[13]=200,t[14]=800*(Math.cos(n)-1),t}},{key:"steps",value:function(t,e){return t[12]=600,t[13]=-400*e,t[14]=-400*e,t}}]),t}();e.default=s,t.exports=e.default},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Mat4=e.Vec3=e.getCSSStyles=e.ARRAY_TYPE=void 0;var i=n(0),o=n(4),a=r(o),s=n(5),u=r(s);e.ARRAY_TYPE=i.ARRAY_TYPE,e.getCSSStyles=i.getCSSStyles,e.Vec3=a,e.Mat4=u},function(t,e,n){"use strict";function r(t,e,n){var r=new a.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new a.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new a.ARRAY_TYPE(3);return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}Object.defineProperty(e,"__esModule",{value:!0}),e.fromValues=r,e.copy=i,e.negate=o;var a=n(0)},function(t,e,n){"use strict";function r(){var t=new d.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new d.ARRAY_TYPE(16),r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=t[9],v=t[10],m=t[11],y=t[12],p=t[13],g=t[14],M=t[15],A=e[0],b=e[1],S=e[2],T=e[3];return n[0]=A*r+b*s+S*f+T*y,n[1]=A*i+b*u+S*h+T*p,n[2]=A*o+b*l+S*v+T*g,n[3]=A*a+b*c+S*m+T*M,A=e[4],b=e[5],S=e[6],T=e[7],n[4]=A*r+b*s+S*f+T*y,n[5]=A*i+b*u+S*h+T*p,n[6]=A*o+b*l+S*v+T*g,n[7]=A*a+b*c+S*m+T*M,A=e[8],b=e[9],S=e[10],T=e[11],n[8]=A*r+b*s+S*f+T*y,n[9]=A*i+b*u+S*h+T*p,n[10]=A*o+b*l+S*v+T*g,n[11]=A*a+b*c+S*m+T*M,A=e[12],b=e[13],S=e[14],T=e[15],n[12]=A*r+b*s+S*f+T*y,n[13]=A*i+b*u+S*h+T*p,n[14]=A*o+b*l+S*v+T*g,n[15]=A*a+b*c+S*m+T*M,n}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d.ARRAY_TYPE(16),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],h=t[10],v=t[11],m=t[12],y=t[13],p=t[14],g=t[15],M=n*s-r*a,A=n*u-i*a,b=n*l-o*a,S=r*u-i*s,T=r*l-o*s,_=i*l-o*u,P=c*y-f*m,R=c*p-h*m,Y=c*g-v*m,E=f*p-h*y,x=f*g-v*y,k=h*g-v*p,w=M*k-A*x+b*E+S*Y-T*R+_*P;return w?(w=1/w,e[0]=(s*k-u*x+l*E)*w,e[1]=(i*x-r*k-o*E)*w,e[2]=(y*_-p*T+g*S)*w,e[3]=(h*T-f*_-v*S)*w,e[4]=(u*Y-a*k-l*R)*w,e[5]=(n*k-i*Y+o*R)*w,e[6]=(p*b-m*_-g*A)*w,e[7]=(c*_-h*b+v*A)*w,e[8]=(a*x-s*Y+l*P)*w,e[9]=(r*Y-n*x-o*P)*w,e[10]=(m*T-y*b+g*M)*w,e[11]=(f*b-c*T-v*M)*w,e[12]=(s*R-a*E-u*P)*w,e[13]=(n*E-r*R+i*P)*w,e[14]=(y*A-m*S-p*M)*w,e[15]=(c*S-f*A+h*M)*w,e):null}function u(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new d.ARRAY_TYPE(16),i=n[0],o=n[1],a=n[2],s=Math.sqrt(i*i+o*o+a*a),u=void 0,l=void 0,c=void 0,f=void 0,h=void 0,v=void 0,m=void 0,y=void 0,p=void 0,g=void 0,M=void 0,A=void 0,b=void 0,S=void 0,T=void 0,_=void 0,P=void 0,R=void 0,Y=void 0,E=void 0,x=void 0,k=void 0,w=void 0,V=void 0;return Math.abs(s)<1e-6?null:(s=1/s,i*=s,o*=s,a*=s,u=Math.sin(e),l=Math.cos(e),c=1-l,f=t[0],h=t[1],v=t[2],m=t[3],y=t[4],p=t[5],g=t[6],M=t[7],A=t[8],b=t[9],S=t[10],T=t[11],_=i*i*c+l,P=o*i*c+a*u,R=a*i*c-o*u,Y=i*o*c-a*u,E=o*o*c+l,x=a*o*c+i*u,k=i*a*c+o*u,w=o*a*c-i*u,V=a*a*c+l,r[0]=f*_+y*P+A*R,r[1]=h*_+p*P+b*R,r[2]=v*_+g*P+S*R,r[3]=m*_+M*P+T*R,r[4]=f*Y+y*E+A*x,r[5]=h*Y+p*E+b*x,r[6]=v*Y+g*E+S*x,r[7]=m*Y+M*E+T*x,r[8]=f*k+y*w+A*V,r[9]=h*k+p*w+b*V,r[10]=v*k+g*w+S*V,r[11]=m*k+M*w+T*V,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)}function l(t){var e=/\(|\)|, |\s/g,n=t.split(e),r=this.create();return console.log(n),"matrix"===n[0]?(r[0]=parseFloat(n[1]),r[1]=parseFloat(n[2]),r[4]=parseFloat(n[3]),r[5]=parseFloat(n[4]),r[12]=parseFloat(n[5]),r[13]=parseFloat(n[6])):"matrix3d"===n[0]&&this.copy(n.slice(1,17).map(function(t){return parseFloat(t)}),r),r}function c(t){var e=(0,d.getCSSStyles)(t,"transform"),n=e.transform;return this.fromCSSTransform(n)}function f(t){return"matrix3d("+t.join(",")+")"}Object.defineProperty(e,"__esModule",{value:!0}),e.create=r,e.copy=i,e.fromTranslation=o,e.multiply=a,e.invert=s,e.rotate=u,e.fromCSSTransform=l,e.fromElement=c,e.toCssTransform=f;var d=n(0)}])});