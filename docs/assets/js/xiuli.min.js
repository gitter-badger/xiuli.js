!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Xiuli=n()}(this,function(){"use strict";var V="undefined"!=typeof Float32Array?Float32Array:Array;function p(t){for(var e=getComputedStyle(t,null),r={},n=arguments.length,i=Array(1<n?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.forEach(function(t){var n=e.getPropertyValue("-webkit-"+t)||e.getPropertyValue("-moz-"+t)||e.getPropertyValue("-ms-"+t)||e.getPropertyValue("-o-"+t)||e.getPropertyValue(""+t)||"none";r[t]=n}),r}function g(t,n,e){var r=new V(3);return r[0]=t,r[1]=n,r[2]=e,r}function b(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return n[12]=t[0],n[13]=t[1],n[14]=t[2],n}function k(t,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new V(16),r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],h=t[7],c=t[8],f=t[9],d=t[10],v=t[11],m=t[12],y=t[13],p=t[14],g=t[15],b=n[0],k=n[1],w=n[2],x=n[3];return e[0]=b*r+k*s+w*c+x*m,e[1]=b*i+k*u+w*f+x*y,e[2]=b*a+k*l+w*d+x*p,e[3]=b*o+k*h+w*v+x*g,b=n[4],k=n[5],w=n[6],x=n[7],e[4]=b*r+k*s+w*c+x*m,e[5]=b*i+k*u+w*f+x*y,e[6]=b*a+k*l+w*d+x*p,e[7]=b*o+k*h+w*v+x*g,b=n[8],k=n[9],w=n[10],x=n[11],e[8]=b*r+k*s+w*c+x*m,e[9]=b*i+k*u+w*f+x*y,e[10]=b*a+k*l+w*d+x*p,e[11]=b*o+k*h+w*v+x*g,b=n[12],k=n[13],w=n[14],x=n[15],e[12]=b*r+k*s+w*c+x*m,e[13]=b*i+k*u+w*f+x*y,e[14]=b*a+k*l+w*d+x*p,e[15]=b*o+k*h+w*v+x*g,e}function a(t,n,e){var r,i,a,o,s,u,l,h,c,f,d,v,m,y,p,g,b,k,w,x,F,M,I,A,T=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new V(16),E=e[0],P=e[1],S=e[2],j=Math.sqrt(E*E+P*P+S*S);return Math.abs(j)<1e-6?null:(E*=j=1/j,P*=j,S*=j,r=Math.sin(n),a=1-(i=Math.cos(n)),o=t[0],s=t[1],u=t[2],l=t[3],h=t[4],c=t[5],f=t[6],d=t[7],v=t[8],m=t[9],y=t[10],p=t[11],g=E*E*a+i,b=P*E*a+S*r,k=S*E*a-P*r,w=E*P*a-S*r,x=P*P*a+i,F=S*P*a+E*r,M=E*S*a+P*r,I=P*S*a-E*r,A=S*S*a+i,T[0]=o*g+h*b+v*k,T[1]=s*g+c*b+m*k,T[2]=u*g+f*b+y*k,T[3]=l*g+d*b+p*k,T[4]=o*w+h*x+v*F,T[5]=s*w+c*x+m*F,T[6]=u*w+f*x+y*F,T[7]=l*w+d*x+p*F,T[8]=o*M+h*I+v*A,T[9]=s*M+c*I+m*A,T[10]=u*M+f*I+y*A,T[11]=l*M+d*I+p*A,t!==T&&(T[12]=t[12],T[13]=t[13],T[14]=t[14],T[15]=t[15]),T)}function w(t){var n=t.split(/\(|\)|, |\s/g),e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return"matrix"===n[0]?(e[0]=parseFloat(n[1]),e[1]=parseFloat(n[2]),e[4]=parseFloat(n[3]),e[5]=parseFloat(n[4]),e[12]=parseFloat(n[5]),e[13]=parseFloat(n[6])):"matrix3d"===n[0]&&function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new V(16);n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]}(n.slice(1,17).map(function(t){return parseFloat(t)}),e),e}function x(t){return"matrix3d("+t.join(",")+")"}var t=function(){function r(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}}(),F=function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,n){var e=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(e.push(o.value),!n||e.length!==n);r=!0);}catch(t){i=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return e}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(){function r(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"xiuli",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,r),this.main=document.getElementById(n),this.main.style.position="absolute",this.main.style.transformStyle="preserve-3d","0s"===p(this.main,"transition","transition-duration")["transition-duration"]&&(this.main.style.transitionDuration="2s",this.main.style.WebkitTransitionDuration="2s"),this.root=this.main.parentElement,this.callback=null,this.data=null,this.main.addEventListener("transitionend",function(){t.callback&&(t.callback(t.elementIds[t.current],t.data),t.data=null)},!1),this.mainTrans=w(p(this.main,"transform").transform),this.init(e)}return t(r,[{key:"init",value:function(){var i=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;this.TFun=t,this.elementIds=[],this.current=-1,this.elements={},this.xiulies=this.main.querySelectorAll("[data-xiuli]"),this.TFun instanceof Function&&Array.prototype.forEach.call(this.xiulies,function(t,n,e){var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];r=i.TFun(r,n,e),t.style.transform=x(r)}),Array.prototype.forEach.call(this.xiulies,function(t,n){var e=!1;0===n&&(e=!0),i.add(t,e)})}},{key:"add",value:function(t,n){var e=p(t,"transform","transform-origin"),r=e.transform,i=e["transform-origin"].match(/[-+]?[0-9]*\.?[0-9]+/g),a=F(i,3),o=a[0],s=void 0===o?0:o,u=a[1],l=void 0===u?0:u,h=a[2],c=void 0===h?0:h,f=w(r),d=g(s,l,c),v=b(d);k(v,f,f),function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new V(3);n[0]=-t[0],n[1]=-t[1],n[2]=-t[2]}(d,d);var m=this.root.offsetWidth,y=this.root.offsetHeight;d[0]-=(m-t.offsetWidth)/2,d[1]-=(y-t.offsetHeight)/2,b(d,v),k(f,v,f),function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new V(16),e=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],h=t[8],c=t[9],f=t[10],d=t[11],v=t[12],m=t[13],y=t[14],p=t[15],g=e*s-r*o,b=e*u-i*o,k=e*l-a*o,w=r*u-i*s,x=r*l-a*s,F=i*l-a*u,M=h*m-c*v,I=h*y-f*v,A=h*p-d*v,T=c*y-f*m,E=c*p-d*m,P=f*p-d*y,S=g*P-b*E+k*T+w*A-x*I+F*M;S&&(S=1/S,n[0]=(s*P-u*E+l*T)*S,n[1]=(i*E-r*P-a*T)*S,n[2]=(m*F-y*x+p*w)*S,n[3]=(f*x-c*F-d*w)*S,n[4]=(u*A-o*P-l*I)*S,n[5]=(e*P-i*A+a*I)*S,n[6]=(y*k-v*F-p*b)*S,n[7]=(h*F-f*k+d*b)*S,n[8]=(o*E-s*A+l*M)*S,n[9]=(r*A-e*E-a*M)*S,n[10]=(v*x-m*k+p*g)*S,n[11]=(c*k-h*x-d*g)*S,n[12]=(s*I-o*T-u*M)*S,n[13]=(e*T-r*I+i*M)*S,n[14]=(m*b-v*w-y*g)*S,n[15]=(h*w-c*b+f*g)*S)}(f,f),k(this.mainTrans,f,f),this.elements[t.id]=x(f),this.elementIds.push(t.id),n&&this.goto(t.id,null)}},{key:"onTransitionend",value:function(t){this.callback=t}},{key:"goto",value:function(t,n){var e=this.elementIds.indexOf(t);-1!==e&&(this.main.style.transform=this.elements[t],this.data=n,this.current=e)}},{key:"pre",value:function(t){this.current-=1,this.current<0&&(this.current=this.elementIds.length-1);var n=this.elementIds[this.current];this.goto(n,t)}},{key:"next",value:function(t){this.current+=1,this.current>=this.elementIds.length&&(this.current=0);var n=this.elementIds[this.current];this.goto(n,t)}}]),r}();var e=Object.freeze({steps:function(t,n){var e=t;return e[12]=600,e[13]=-400*n,e[14]=-400*n,e},circular:function(t,n){var e=6.28319*n/6,r=t;return r[12]=600*Math.sin(e),r[13]=200,r[14]=800*(Math.cos(e)-1),r},spiralSteps:function(t,n,e){var r=t,i=6.28319*n/e.length;return a(t,i-1.5708,g(0,1,0),t),r[12]=500*Math.sin(i),r[13]=-400*n,r[14]=500*(Math.cos(i)-1),r},spiralRotated:function(t,n){var e=t,r=6.28319*n/6;return a(t,r,g(0,1,0),t),e[12]=600*Math.sin(r),e[13]=200*n,e[14]=600*(Math.cos(r)-1),t},poly:function(t,n){var e=t,r=6.28319*n/6;return a(t,r,g(0,1,0),t),e[12]=600*Math.sin(r),e[13]=200,e[14]=600*(Math.cos(r)-1),t}});return n.initializers=e,n});
//# sourceMappingURL=xiuli.min.js.map
